##### 엔티티 설계시 주의점
1. 엔티티에는 가급적 Setter를 사용하지 말자.
    - Setter를 열어두게되면 엔티티가 변경되는 포인트가 많아져 유지보수가 어려워진다.
2. 모든 연관관계는 지연로딩으로 설정
    - 즉시로딩은 어떤 SQL이 실행될지 예측하기 어렵다. (최악의 상황에서는 연관된 모든 데이터를 모두 가져와서 메모리 부족이 발생가능)
    - 연관된 엔티티를 함께 조회해야 한다면 fetch join 또는 엔티티 그래프 기능 사용
3. 컬렉션은 필드에서 초기화하자.
    - ```java
      @OneToMany(mappedBy = "order")
      private List<OrderItem> orderItems = new ArrayList<>();
      ```
    - 필드에서 초기화 하는것이 가장 안전하고, 코드도 간결하다.

##### 변경 감지 (dirty checking)와 병합 (merge)
* 준영속 엔티티
    - 영속성 컨테이너에서 더이상 관리되지 않는 엔티티
    - 준영속 엔티티를 수정하는 2가지 방법
        1. 변경 감지 기능 사용 (추천)
            - 영속 상태로 만든 후 변경 감지가 되도록
        2. 병합 (merge) 사용 (모든 속성이 변경되는 등 위험성이 있으므로 가급적 병합은 사용하지 않는다.)
            - 준영속 상태의 엔티티를 영속 상태로 변경한다.
            - 변경 감지 기능을 사용하면 원하는 속성만 선택해서 변경할 수 있지만, 병합을 사용하면 모든 속성이 변경된다. (주의 특정 필드가 null인 상태로 병합되면 DB에 null로 저장 됨.)


#### Reference
실전! 스프링 부트와 JPA 활용1.김영한.인프런강의